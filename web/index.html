<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HMRC v2 — Quick Calculator</title>
  <link rel="stylesheet" href="/web/style.css" />
</head>
<body>
  <div class="container">
    <h1>HMRC v2 — Input & Validation Page</h1>
    <p class="hint">Sections: user inputs and computed fields marked with [C]. Fill inputs and click "Compute". Note: Accounting periods > 12 months are automatically split per HMRC rules (check console).</p>

    <form id="dataForm">
      <div class="grid">
        <section class="card">
          <h2>Section 1</h2>
          <label>Start date of Accounting Period
            <input type="date" id="apStart" required />
          </label>
          <label>End date of Accounting Period
            <input type="date" id="apEnd" required />
          </label>
          <label>Number of associated companies
            <input type="number" id="assocCompanies" min="0" value="0" />
          </label>
        </section>

        <section class="card">
          <h2>Section 2</h2>
          <label>Turnover
            <input type="number" id="turnover" step="0.01" value="0" />
          </label>
          <label>Government grants & subsidies
            <input type="number" id="govtGrants" step="0.01" value="0" />
          </label>
          <label>Rental & property income
            <input type="number" id="rentalIncome" step="0.01" value="0" />
          </label>
          <label>Interest Income
            <input type="number" id="interestIncome" step="0.01" value="0" />
          </label>
          <label>Dividend income
            <input type="number" id="dividendIncome" step="0.01" value="0" />
          </label>

          <label class="computed">Total Income [C]
            <input type="text" id="totalIncome" readonly data-key="totalIncome" />
          </label>

          <hr />

          <label>Raw Materials & Consumables
            <input type="number" id="rawMaterials" step="0.01" value="0" />
          </label>
          <label>Staff Costs
            <input type="number" id="staffCosts" step="0.01" value="0" />
          </label>
          <label>Depreciation
            <input type="number" id="depreciation" step="0.01" value="0" />
          </label>
          <label>Other Charges
            <input type="number" id="otherCharges" step="0.01" value="0" />
          </label>

          <label class="computed">Total Expenses [C]
            <input type="text" id="totalExpenses" readonly data-key="totalExpenses" />
          </label>

          <label class="computed">Profit (Loss) before tax [C]
            <input type="text" id="profitBeforeTax" readonly data-key="profitBeforeTax" />
          </label>

          <label class="computed">Tax on Profit [C]
            <input type="text" id="taxOnProfit" readonly data-key="taxOnProfit" />
          </label>

          <label class="computed">Profit (Loss) for the period [C]
            <input type="text" id="profitForPeriod" readonly data-key="profitForPeriod" />
          </label>
        </section>

        <section class="card">
          <h2>Section 3</h2>
          <label class="computed">Trading Profit / loss before tax [C]
            <input type="text" id="tradingProfitBeforeTax" readonly data-key="tradingProfitBeforeTax" />
          </label>
          <label class="computed">Add back: Depreciation [C]
            <input type="text" id="addbackDepreciation" readonly data-key="addbackDepreciation" />
          </label>
          <label>Add back: Disallowable expenses
            <input type="number" id="disallowableExpenses" step="0.01" value="0" />
          </label>
          <label>Other adjustments (add if positive, deduct if negative)
            <input type="number" id="otherAdjustments" step="0.01" value="0" />
          </label>
          <label>Less: AIA (Trade)
            <input type="number" id="aiaTrade" step="0.01" value="0" />
          </label>
          <label>Less: AIA (Non-Trade)
            <input type="number" id="aiaNonTrade" step="0.01" value="0" />
          </label>
          <label>Less: Trading losses brought forward
            <input type="number" id="tradingLossBF" step="0.01" value="0" />
          </label>

          <label class="computed">Net trading profits [C]
            <input type="text" id="netTradingProfits" readonly data-key="netTradingProfits" />
          </label>
        </section>

        <section class="card">
          <h2>Section 4</h2>
          <label class="computed">Interest income [C]
            <input type="text" id="outInterestIncome" readonly data-key="outInterestIncome" />
          </label>
          <label class="computed">Government grants & subsidies [C]
            <input type="text" id="outGovtGrants" readonly data-key="outGovtGrants" />
          </label>
          <label class="computed">Dividend income [C]
            <input type="text" id="outDividendIncome" readonly data-key="outDividendIncome" />
          </label>

          <label class="computed">Rental & property income [C]
            <input type="text" id="outRentalIncome" readonly data-key="outRentalIncome" />
          </label>
          <label>Less: rental & property losses brought forward
            <input type="number" id="rentalLossBF" step="0.01" value="0" />
          </label>
          <label class="computed">Net rental & property income [C]
            <input type="text" id="netRentalIncome" readonly data-key="netRentalIncome" />
          </label>
        </section>

        <section class="card wide">
          <h2>Section 5</h2>
          <label class="computed">Profits chargeable to corporation tax [C]
            <input type="text" id="ttProfitsChargeable" readonly data-key="ttProfitsChargeable" />
          </label>
          <label class="computed">Corporation tax payable [C]
            <input type="text" id="corpTaxPayable" readonly data-key="corpTaxPayable" />
          </label>
        </section>
      </div>

      <div class="actions">
        <button type="button" id="computeBtn">Compute</button>
        <button type="button" id="resetBtn">Reset</button>
      </div>

    </form>

    <!-- RHS sliding panel for formula / details -->
    <aside id="formulaPanel" aria-hidden="true">
      <button id="closePanel" aria-label="Close">×</button>
      <div id="formulaContent">
        <h3 id="formulaTitle">Formula</h3>
        <pre id="formulaText"></pre>
        <h4>Detailed Calculation</h4>
        <pre id="formulaDetails"></pre>
        <hr />
        <div id="sliderControls" style="display:none;">
          <label><input type="checkbox" id="enableSlider" /> Enable slider to adjust value</label>
          <div id="sliderWrap" style="margin-top:8px; display:none;">
            <input type="range" id="formulaSlider" min="0" max="100" step="1" />
            <div style="margin-top:6px; display:flex; gap:8px; align-items:center;">
              <span>Adjusted value:</span>
              <output id="sliderValue">0</output>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <footer>
      <p>Ready to deploy to Vercel: drop the <code>web</code> folder into a repo and link to Vercel.</p>
    </footer>
  </div>

  <script src="../taxModel.js"></script>
  <script src="../taxEngine.js"></script>
  <script src="app.js"></script>
</body>
</html>